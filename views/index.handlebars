<!DOCTYPE html>
<html>
    <head>
        <title>This will be a modal</title>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    </head>
    <body>
        <div class="show-user-name"></div>
        <form>
            <div class="form-group">
                <label for="exampleInputEmail1">Email address</label>
                <input type="email" class="form-control" id="email-login" aria-describedby="emailHelp" placeholder="Enter email">
            </div>
            <div class="form-group">
                <label for="exampleInputPassword1">Password</label>
                <input type="password" class="form-control" name="password" id="password-login" placeholder="Password">
            </div>
            <div class="form-check">
                <button class="btn btn-info open-modal" type="button">Register</button> 
                <button type="submit" class="btn btn-primary" id="login-submit">Submit</button>
            </div>
        </form>
                      
        {{!-- <button class="open-modal">Open Modal</button> --}}

        <div class="modal" id="register-modal" tabindex="-1" role="dialog" style="overflow-y:auto">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Register</h5>
                    <button type="button" id="modal-x" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                        <form>
                                <div class="container">
                                <div class="form-row">
                                    <div class="form-group col-md-12">
                                      <label for="inputEmail">Email</label>
                                      <input type="email" class="form-control form-control-sm" id="inputEmail" placeholder="Email">
                                    </div>  
                                </div>
                                
                                <div class="form-row">
                                    <div class="form-group col-md-6">
                                        <label for="inputPassword1">Password</label>
                                        <input type="password" class="form-control form-control-sm" id="inputPassword1" placeholder="Password">
                                    </div>
                                    
                                    <div class="form-group col-md-6">
                                    <label for="inputPassword2">Re-enter Password</label>
                                    <input type="password" class="form-control form-control-sm" id="inputPassword2" placeholder="Re-enter Password">
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group col-md-6">
                                        <label for="inputFirstName">First Name</label>
                                        <input type="firstName" class="form-control form-control-sm" id="inputFirstName" placeholder="First Name">
                                    </div>
                                    
                                    <div class="form-group col-md-6">
                                        <label for="inputLastName">Last Name</label>
                                        <input type="lastName" class="form-control form-control-sm" id="inputLastName" placeholder="Last Name">
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group col-md-12">
                                        <label for="inputAddress">Address</label>
                                        <input type="text" class="form-control form-control-sm" id="inputAddress" placeholder="1234 Main St">
                                    </div>
                                </div>
                                
                                <div class="form-row">
                                    <div class="form-group col-md-6">
                                        <label for="inputAddress2">Address 2</label>
                                        <input type="text" class="form-control form-control-sm" id="inputAddress2" placeholder="Apartment/Suite">
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group col-md-5">
                                        <label for="inputCity">City</label>
                                        <input type="text" class="form-control form-control-sm" id="inputCity">
                                    </div>
                                
                                    <div class="form-group col-md-3">
                                        <label for="inputState">State</label>
                                            <select id="inputState" class="form-control">
                                                <option selected>Choose...</option>
                                                <option value="AK">Alaska</option>
                                                <option value="AL">Alabama</option>
                                                <option value="AR">Arkansas</option>
                                                <option value="AZ">Arizona</option>
                                                <option value="CA">California</option>
                                                <option value="CO">Colorado</option>
                                                <option value="CT">Connecticut</option>
                                                <option value="DC">District of Columbia</option>
                                                <option value="DE">Delaware</option>
                                                <option value="FL">Florida</option>
                                                <option value="GA">Georgia</option>
                                                <option value="HI">Hawaii</option>
                                                <option value="IA">Iowa</option>
                                                <option value="ID">Idaho</option>
                                                <option value="IL">Illinois</option>
                                                <option value="IN">Indiana</option>
                                                <option value="KS">Kansas</option>
                                                <option value="KY">Kentucky</option>
                                                <option value="LA">Louisiana</option>
                                                <option value="MA">Massachusetts</option>
                                                <option value="MD">Maryland</option>
                                                <option value="ME">Maine</option>
                                                <option value="MI">Michigan</option>
                                                <option value="MN">Minnesota</option>
                                                <option value="MO">Missouri</option>
                                                <option value="MS">Mississippi</option>
                                                <option value="MT">Montana</option>
                                                <option value="NC">North Carolina</option>
                                                <option value="ND">North Dakota</option>
                                                <option value="NE">Nebraska</option>
                                                <option value="NH">New Hampshire</option>
                                                <option value="NJ">New Jersey</option>
                                                <option value="NM">New Mexico</option>
                                                <option value="NV">Nevada</option>
                                                <option value="NY">New York</option>
                                                <option value="OH">Ohio</option>
                                                <option value="OK">Oklahoma</option>
                                                <option value="OR">Oregon</option>
                                                <option value="PA">Pennsylvania</option>
                                                <option value="PR">Puerto Rico</option>
                                                <option value="RI">Rhode Island</option>
                                                <option value="SC">South Carolina</option>
                                                <option value="SD">South Dakota</option>
                                                <option value="TN">Tennessee</option>
                                                <option value="TX">Texas</option>
                                                <option value="UT">Utah</option>
                                                <option value="VA">Virginia</option>
                                                <option value="VT">Vermont</option>
                                                <option value="WA">Washington</option>
                                                <option value="WI">Wisconsin</option>
                                                <option value="WV">West Virginia</option>
                                                <option value="WY">Wyoming</option>
                                            </select>
                                    </div>
                                  
                                    <div class="form-group col-md-4">
                                        <label for="inputZip">Zip</label>
                                        <input type="text" class="form-control" id="inputZip">
                                    </div>
                                </div>
                                
                                <div class="form-row">
                                    <div class="form-group col-md-6">
                                        <label for="inputPhone">Phone Number</label>
                                        <input type="text" class="form-control" id="inputPhone">
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="col-sm-12">When is the best time to call?</div>
                                        <div class="col-sm-10">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="timeCheck1">
                                                <label class="form-check-label" for="timeCheck1">Morning</label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="timeCheck2">
                                                <label class="form-check-label" for="timeCheck2">Afternoon</label>
                                            </div>
                                            <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="timeCheck3">
                                                    <label class="form-check-label" for="timeCheck3">Evening</label>
                                            </div>
                                        </div>
                                    </div>
                                <div class="form-group row mt-3">
                                    <div class="col-sm-12">Check the items you would like to learn more about:</div>
                                        <div class="col-sm-10">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="gridCheck1">
                                                <label class="form-check-label" for="gridCheck1">Research opportunities</label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="gridCheck2">
                                                <label class="form-check-label" for="gridCheck2">Giving opportunities</label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="gridCheck3">
                                                <label class="form-check-label" for="gridCheck3">I'd like to receive the Vital newsletter</label>
                                            </div>
                                        </div>
                                </div>
                                
                            </div>
                        </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" id="modal-close" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id="modal-save">Save</button>
                </div>
                </div>
            </div>
        </div>
    </body>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script>
      //==========================================================================
      //====need to move all this to public folder linked from main.handlebars====
      //==========================================================================

      let activeUser = {};
        
        $(document).on('click', '.open-modal', function(){
            $('#register-modal').toggle();
        })

        $(document).on('click', '#modal-x', function(){
            $('#register-modal').toggle();
        })

        $(document).on('click', '#modal-close', function(){
            $('#register-modal').toggle();
        })

        $(document).on('click', '#modal-save', function(){
            //check if passwords match
            if($('#inputPassword1').val().trim() !== $('#inputPassword2').val().trim()) {
                //need to create function that displays to user that the passwords DON'T match and a newUser was not created
                mismatchPassword();
                return false;
            }
            //captures users data to send to db
            let newUser = {
                first_name: $('#inputFirstName').val().trim(),
                last_name: $('#inputLastName').val().trim(),
                address1: $('#inputAddress').val().trim(),
                address2: $('#inputAddress2').val().trim(),
                city: $('#inputCity').val().trim(),
                state: $('#inputState').val(),
                zipcode: $('#inputZip').val().trim(),
                telephone: $('#inputPhone').val().trim(),
                email: $('#inputEmail').val().trim(),
                password: $('#inputPassword1').val().trim(),
                learnMoreResearchOpp: $('#gridCheck1').is(':checked'),
                learnMoreGivingOpp: $('#gridCheck2').is(':checked'),
                learnMoreVitaNews: $('#gridCheck3').is(':checked'),
                time_to_call_morning: $('#timeCheck1').is(':checked'),
                time_to_call_afternoon: $('#timeCheck2').is(':checked'),
                time_to_call_evening: $('#timeCheck3').is(':checked')
            }

            //send post request
            $.post('/api/users', newUser).then(data=>{
                if(data){
                    activeUser = {
                      name: newUser.first_name,
                      id: data.id
                    }
                    $('#register-modal').toggle();
                    console.log(activeUser);
                }else{
                    noUserCreated();
                }
            });
            showActiveUser();
        });

        $(document).on('click', '#login-submit', function(event){
            event.preventDefault();

            if (!$('#email-login').val() || !$('#password-login').val()){
                return false;
            }

            userLogin = {
                email: $('#email-login').val().trim(),
                password: $('#password-login').val().trim()
            }

            $.post('/api/users-login', userLogin, function(response){
                if(response){
                    activeUser = {
                        name: response.first_name,
                        id: response.id
                    }
                    showActiveUser();
                }else{
                    noUserFound();
                }
            })
        })
        
        // function to display which user is logged into the page
        function showActiveUser(){
            if(activeUser){
                $('.show-user-name').text(activeUser.name)
            }
        }

    </script>
</html>

